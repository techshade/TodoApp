import{r,_ as ae,U as re,a8 as ne,M as R,ae as y,b as ie,aQ as l,j as e,T as le,aR as de,aS as ce,aT as ge,aU as me,E as he,x as xe,aV as Y,ag as G,al as je,aW as pe,ac as V,aX as ue,am as X,l as Ce,aY as fe,f as z,g as H,h as J,I as K,J as E,aZ as ye,a_ as Ee,aB as ke,K as k}from"./index-DHRrVd1t.js";import{D as ve}from"./Delete-9XRJBhZd.js";const De=r.lazy(()=>ae(()=>import("./NotFound-Bjb0MmcR.js"),__vite__mapDeps([0,1,2]))),Te=()=>{var q,F;const{user:s,setUser:v}=r.useContext(re),j=ne(),[d,$]=R("","catName","sessionStorage"),[D,N]=r.useState(""),[p,B]=R(null,"catEmoji","sessionStorage"),[S,I]=R(j.primary,"catColor","sessionStorage"),[Q,u]=r.useState(!1),[i,T]=r.useState(),[Z,b]=r.useState(!1),[g,A]=r.useState(""),[C,_]=r.useState(""),[U,L]=r.useState(),[f,P]=r.useState(y.purple),M=ie();r.useEffect(()=>{document.title="Todo App - Categories",s.settings[0].enableCategories||M("/"),d.length>l&&N(`Name is too long maximum ${l} characters`)},[M,d.length,s.settings]),r.useEffect(()=>{var t,o;P(((t=s.categories.find(a=>a.id===i))==null?void 0:t.color)||y.purple),A(((o=s.categories.find(a=>a.id===i))==null?void 0:o.name)||""),_("")},[i,s.categories]);const O=t=>{var o;if(t){const a=((o=s.categories.find(n=>n.id===t))==null?void 0:o.name)||"",c=s.categories.filter(n=>n.id!==t),h=s.tasks.map(n=>{var m;const x=(m=n.category)==null?void 0:m.filter(w=>w.id!==t);return{...n,category:x}});v({...s,categories:c,tasks:h}),k(e.jsxs("div",{children:["Deleted category - ",e.jsxs("b",{translate:"no",children:[a,"."]})]}))}},ee=t=>{const o=t.target.value;$(o),o.length>l?N(`Name is too long (maximum ${l} characters)`):N("")},te=t=>{const o=t.target.value;A(o),o.length>l?_(`Name is too long (maximum ${l} characters)`):_("")},se=()=>{if(d!==""){if(d.length>l)return;const t={id:crypto.randomUUID(),name:d,emoji:p!==""&&p!==null?p:void 0,color:S};k(e.jsxs("div",{children:["Added category - ",e.jsx("b",{translate:"no",children:t.name})]})),v(o=>({...o,categories:[...o.categories,t]})),$(""),I(j.primary),B("")}else k("Category name is required.",{type:"error"})},W=()=>{T(void 0),b(!1),P(j.primary),A(""),L(void 0)},oe=()=>{if(i){const t=s.categories.map(a=>a.id===i?{...a,name:g,emoji:U||void 0,color:f}:a),o=s.tasks.map(a=>{var h;const c=(h=a.category)==null?void 0:h.map(n=>n.id===i?{id:i,name:g,emoji:U||void 0,color:f}:n);return{...a,category:c}});v({...s,categories:t,tasks:o}),k(e.jsxs("div",{children:["Updated category - ",e.jsx("b",{translate:"no",children:g})]})),b(!1)}};return s.settings[0].enableCategories?e.jsxs(e.Fragment,{children:[e.jsx(le,{title:"Categories"}),e.jsxs(de,{children:[s.categories.length>0?e.jsx(ce,{children:s.categories.map(t=>{const o=s.tasks.filter(x=>{var m;return(m=x.category)==null?void 0:m.some(w=>w.id===t.id)}),a=o.reduce((x,m)=>m.done?x+1:x,0),c=o.length,h=c>0?Math.floor(a/c*100):0,n=c>0?`(${h}%)`:"";return e.jsxs(ge,{clr:t.color,children:[e.jsxs(me,{translate:"no",children:[e.jsx("span",{children:t.emoji&&e.jsx(he,{unified:t.emoji,emojiStyle:s.emojisStyle})})," ",e.jsx("span",{style:{wordBreak:"break-all",fontWeight:600},children:t.name}),c>0&&e.jsx(xe,{title:"The percentage of completion of tasks assigned to this category",children:e.jsx("span",{style:{opacity:.8,fontStyle:"italic"},children:n})})]}),e.jsxs("div",{style:{display:"flex",gap:"4px"},children:[e.jsx(Y,{children:e.jsx(G,{color:"primary",onClick:()=>{T(t.id),b(!0)},children:e.jsx(je,{})})}),e.jsx(Y,{children:e.jsx(G,{color:"error",onClick:()=>{T(t.id),c>0?u(!0):O(t.id)},children:e.jsx(ve,{})})})]})]},t.id)})}):e.jsx("p",{children:"You don't have any categories"}),e.jsxs(pe,{children:[e.jsx("h2",{children:"Add New Category"}),e.jsx(V,{emoji:typeof p=="string"?p:void 0,setEmoji:B,color:S}),e.jsx(ue,{focused:!0,required:!0,label:"Category name",placeholder:"Enter category name",value:d,onChange:ee,error:D!=="",helperText:d==""?void 0:D||`${d.length}/${l}`}),e.jsx(X,{color:S,onColorChange:t=>{I(t)},width:360,fontColor:Ce(j.secondary)}),e.jsx(fe,{onClick:se,disabled:d.length>l,children:"Create Category"})]}),e.jsxs(z,{open:Q,onClose:()=>u(!1),PaperProps:{style:{borderRadius:"24px",padding:"12px",maxWidth:"600px"}},children:[e.jsxs(H,{children:["Confirm deletion of"," ",e.jsx("b",{children:(q=s.categories.find(t=>t.id===i))==null?void 0:q.name})]}),e.jsx(J,{children:"This will remove the category from your list and associated tasks."}),e.jsxs(K,{children:[e.jsx(E,{onClick:()=>u(!1),children:"Cancel"}),e.jsxs(E,{onClick:()=>{O(i),u(!1)},color:"error",children:[e.jsx(ye,{}),"   Delete"]})]})]}),e.jsxs(z,{open:Z,onClose:W,PaperProps:{style:{borderRadius:"24px",padding:"12px",maxWidth:"600px"}},children:[e.jsx(H,{children:"Edit Category"}),e.jsxs(J,{children:[e.jsx(V,{emoji:((F=s.categories.find(t=>t.id===i))==null?void 0:F.emoji)||void 0,setEmoji:L,width:300,color:f}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[e.jsx(Ee,{label:"Enter category name",placeholder:"Enter category name",value:g,error:C!==""||g.length===0,onChange:te,helperText:C||(g.length===0?"Category name is required":`${g.length}/${l}`)}),e.jsx(X,{color:f,width:"300px",fontColor:j.darkmode?y.fontLight:y.fontDark,onColorChange:t=>{P(t)}})]})]}),e.jsxs(K,{children:[e.jsx(E,{onClick:W,children:"Cancel"}),e.jsxs(E,{onClick:oe,disabled:C!==""||g.length===0,children:[e.jsx(ke,{}),"   Save"]})]})]})]})]}):e.jsx(De,{message:"Categories are not enabled."})};export{Te as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/NotFound-Bjb0MmcR.js","assets/index-DHRrVd1t.js","assets/index-BS98ZIQC.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
