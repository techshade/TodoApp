import{c as v,j as e,r as a,U as B,b as M,d as O,e as _,f as G,g as S,h as T,i as V,k as W,l as h,m as $,o as w,E as C,s as q,p as J,q as X,t as K,v as Q,w as Y,x as E,y as Z,z as ee,A as se,R as te,B as ne,C as oe,F as j,G as ae,H as re,I as L,J as p,K as ie,L as de}from"./index-DHRrVd1t.js";import{f as le}from"./formatDate-D_Tte-IX.js";import ce from"./Home-BdjtDye4.js";import{A as R}from"./AddTaskRounded-Cl-1mP_v.js";import"./TodayRounded-CBYr_2U8.js";const xe=v(e.jsx("path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2M4 12c0-4.4 3.6-8 8-8 1.8 0 3.5.6 4.9 1.7L5.7 16.9C4.6 15.5 4 13.8 4 12m8 8c-1.8 0-3.5-.6-4.9-1.7L18.3 7.1C19.4 8.5 20 10.2 20 12c0 4.4-3.6 8-8 8"}),"DoNotDisturbAltRounded"),me=v(e.jsx("path",{d:"M17 7h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.43-.98 2.63-2.31 2.98l1.46 1.46C20.88 15.61 22 13.95 22 12c0-2.76-2.24-5-5-5m-1 4h-2.19l2 2H16zM2 4.27l3.11 3.11C3.29 8.12 2 9.91 2 12c0 2.76 2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1 0-1.59 1.21-2.9 2.76-3.07L8.73 11H8v2h2.73L13 15.27V17h1.73l4.01 4L20 19.74 3.27 3z"}),"LinkOff"),ge=()=>{const{user:l,setUser:A}=a.useContext(B),r=M(),I=O(),u=new URLSearchParams(I.search),c=u.get("task"),x=u.get("userName"),[s,U]=a.useState(null),[f,N]=a.useState(""),[b,i]=a.useState(!1),[g,d]=a.useState(),k=t=>/^#[0-9A-Fa-f]{6}$/.test(t);a.useEffect(()=>{if(c)try{const t=decodeURIComponent(c),n={...JSON.parse(t),id:crypto.randomUUID()};if(!k(n.color)){i(!0),d("Invalid task color format.");return}n.category&&n.category.forEach(o=>{if(!k(o.color)){i(!0),d("Invalid category color format.");return}}),U(n)}catch(t){console.error("Error decoding task data:",t),d("Error decoding task data."+t),i(!0)}if(x){const t=decodeURIComponent(x);t.length>_&&(i(!0),d("User name is too long.")),N(t)}},[c,x]),a.useEffect(()=>{document.title=`Todo App - Recieved Task ${s?"("+s.name+")":""}`},[s]);const P=()=>{if(s){const t=[...l.categories];s.category&&s.category.forEach(n=>{const o=t.findIndex(y=>y.id===n.id);o!==-1?t[o]=n:t.push(n)}),A(n=>({...n,categories:t,tasks:[...n.tasks.filter(Boolean),{...s,id:crypto.randomUUID(),sharedBy:f}]})),r("/"),ie(e.jsxs("div",{children:["Added shared task - ",e.jsx("b",{translate:"no",children:s.name})]}),{icon:e.jsx(R,{})})}},z=t=>{if(!t||!t.description)return null;const{description:n,color:o}=t,F=n.split(j).map((m,D)=>{if(D%2===0)return m;{const H=new URL(m);return e.jsx(E,{title:m,children:e.jsx(de,{clr:o,disabled:!0,children:e.jsxs("div",{children:[e.jsx(me,{sx:{fontSize:"24px"}})," ",H.hostname]})})},D)}});return e.jsx("div",{children:F})};return e.jsxs("div",{children:[e.jsx(ce,{}),e.jsx(G,{open:!0,PaperProps:{style:{borderRadius:"24px",padding:" 10px 6px",width:"100% !important"}},children:!b&&s?e.jsxs(e.Fragment,{children:[e.jsx(S,{children:"Recieved Task"}),e.jsxs(T,{children:[e.jsxs("p",{style:{fontSize:"16px",marginLeft:"6px"},children:[e.jsx("b",{translate:"no",children:f})," shared you a task."]}),e.jsxs(V,{done:s.done,backgroundColor:s.color,style:{maxWidth:"600px",opacity:1,padding:"16px 22px"},children:[s.emoji||s.done?e.jsx(W,{clr:h(s.color),children:s.done?e.jsx($,{fontSize:"large"}):l.emojisStyle===w.NATIVE?e.jsx("div",{children:e.jsx(C,{size:q.os==="iOS"?48:36,unified:s.emoji||"",emojiStyle:w.NATIVE})}):e.jsx(C,{size:48,unified:s.emoji||"",emojiStyle:l.emojisStyle})}):null,e.jsxs(J,{translate:"no",style:{marginRight:"14px"},children:[s.pinned&&e.jsxs(X,{translate:"yes",children:[e.jsx(K,{fontSize:"small"}),"   Pinned"]}),e.jsxs(Q,{style:{gap:"6px"},children:[e.jsx(Y,{done:s.done,children:s.name}),e.jsx(E,{title:new Intl.DateTimeFormat(navigator.language,{dateStyle:"full",timeStyle:"medium"}).format(new Date(s.date)),children:e.jsx(Z,{children:le(new Date(s.date))})})]}),e.jsx(ee,{done:s.done,children:z(s)}),s.deadline&&e.jsxs(se,{done:s.done,children:[e.jsx(te,{fontSize:"small",animate:new Date>new Date(s.deadline)&&!s.done,sx:{color:`${h(s.color)} !important`}})," Deadline: ",new Date(s.deadline).toLocaleDateString()," "," • ",new Date(s.deadline).toLocaleTimeString(),!s.done&&e.jsxs(e.Fragment,{children:[" • ",ne(new Date(s.deadline))]})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px 6px",justifyContent:"left",alignItems:"center"},children:s.category&&s.category.map(t=>e.jsx("div",{children:e.jsx(oe,{category:t,borderclr:h(s.color)})},t.id))})]})]}),s&&s.description&&s.description.match(j)?e.jsxs(ae,{sx:{mt:"20px"},severity:"warning",children:[e.jsx(re,{children:"This task contains the following links:"})," ",(()=>{var n;const t=(n=s.description.match(j))==null?void 0:n.map(o=>o);if(t){const o=new Intl.ListFormat("en-US",{style:"long",type:"conjunction"});return e.jsx("span",{style:{wordBreak:"break-all"},children:o.format(t)})}return null})()]}):null]}),e.jsxs(L,{children:[e.jsxs(p,{color:"error",onClick:()=>r("/"),children:[e.jsx(xe,{}),"   Decline"]}),e.jsxs(p,{onClick:()=>{P(),r("/")},children:[e.jsx(R,{}),"   Add Task"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{children:"Something went wrong"}),e.jsx(T,{children:e.jsxs("p",{children:["Oops! Something went wrong while processing the shared task."," ",g&&e.jsxs("b",{children:[e.jsx("br",{})," ",g]})]})}),e.jsx(L,{children:e.jsx(p,{onClick:()=>r("/"),children:"Close"})})]})})]})};export{ge as default};
